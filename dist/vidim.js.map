{"version":3,"file":"vidim.js","sources":["../node_modules/component-emitter/index.js","../src/utils.js","../src/providers/html5.js","../src/providers/youtube.js","../src/index.js"],"sourcesContent":["\r\n/**\r\n * Expose `Emitter`.\r\n */\r\n\r\nif (typeof module !== 'undefined') {\r\n  module.exports = Emitter;\r\n}\r\n\r\n/**\r\n * Initialize a new `Emitter`.\r\n *\r\n * @api public\r\n */\r\n\r\nfunction Emitter(obj) {\r\n  if (obj) return mixin(obj);\r\n};\r\n\r\n/**\r\n * Mixin the emitter properties.\r\n *\r\n * @param {Object} obj\r\n * @return {Object}\r\n * @api private\r\n */\r\n\r\nfunction mixin(obj) {\r\n  for (var key in Emitter.prototype) {\r\n    obj[key] = Emitter.prototype[key];\r\n  }\r\n  return obj;\r\n}\r\n\r\n/**\r\n * Listen on the given `event` with `fn`.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.on =\r\nEmitter.prototype.addEventListener = function(event, fn){\r\n  this._callbacks = this._callbacks || {};\r\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\r\n    .push(fn);\r\n  return this;\r\n};\r\n\r\n/**\r\n * Adds an `event` listener that will be invoked a single\r\n * time then automatically removed.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.once = function(event, fn){\r\n  function on() {\r\n    this.off(event, on);\r\n    fn.apply(this, arguments);\r\n  }\r\n\r\n  on.fn = fn;\r\n  this.on(event, on);\r\n  return this;\r\n};\r\n\r\n/**\r\n * Remove the given callback for `event` or all\r\n * registered callbacks.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.off =\r\nEmitter.prototype.removeListener =\r\nEmitter.prototype.removeAllListeners =\r\nEmitter.prototype.removeEventListener = function(event, fn){\r\n  this._callbacks = this._callbacks || {};\r\n\r\n  // all\r\n  if (0 == arguments.length) {\r\n    this._callbacks = {};\r\n    return this;\r\n  }\r\n\r\n  // specific event\r\n  var callbacks = this._callbacks['$' + event];\r\n  if (!callbacks) return this;\r\n\r\n  // remove all handlers\r\n  if (1 == arguments.length) {\r\n    delete this._callbacks['$' + event];\r\n    return this;\r\n  }\r\n\r\n  // remove specific handler\r\n  var cb;\r\n  for (var i = 0; i < callbacks.length; i++) {\r\n    cb = callbacks[i];\r\n    if (cb === fn || cb.fn === fn) {\r\n      callbacks.splice(i, 1);\r\n      break;\r\n    }\r\n  }\r\n\r\n  // Remove event specific arrays for event types that no\r\n  // one is subscribed for to avoid memory leak.\r\n  if (callbacks.length === 0) {\r\n    delete this._callbacks['$' + event];\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n/**\r\n * Emit `event` with the given args.\r\n *\r\n * @param {String} event\r\n * @param {Mixed} ...\r\n * @return {Emitter}\r\n */\r\n\r\nEmitter.prototype.emit = function(event){\r\n  this._callbacks = this._callbacks || {};\r\n\r\n  var args = new Array(arguments.length - 1)\r\n    , callbacks = this._callbacks['$' + event];\r\n\r\n  for (var i = 1; i < arguments.length; i++) {\r\n    args[i - 1] = arguments[i];\r\n  }\r\n\r\n  if (callbacks) {\r\n    callbacks = callbacks.slice(0);\r\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\r\n      callbacks[i].apply(this, args);\r\n    }\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n/**\r\n * Return array of callbacks for `event`.\r\n *\r\n * @param {String} event\r\n * @return {Array}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.listeners = function(event){\r\n  this._callbacks = this._callbacks || {};\r\n  return this._callbacks['$' + event] || [];\r\n};\r\n\r\n/**\r\n * Check if this emitter has `event` handlers.\r\n *\r\n * @param {String} event\r\n * @return {Boolean}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.hasListeners = function(event){\r\n  return !! this.listeners(event).length;\r\n};\r\n","// Simple utility function for setting default values\nexport function setDefaults( object, defaults ) {\n\n  const defaultsKeys = Object.keys( defaults );\n\n  defaultsKeys.forEach( ( key ) => {\n\n    if ( ! object.hasOwnProperty( key ) ) {\n\n      object[ key ] = defaults[ key ];\n\n    }\n\n  });\n\n}\n\n// Utility function for when we need to accept the DOM element\nexport function getElement( query, parent = document ) {\n\n  if ( 'string' === typeof query ) {\n\n    return parent.querySelector( query );\n\n  }\n\n  return query;\n\n}\n\n// Thanks underscore.js :)\nexport function throttle(func, wait) {\n  var timeout, context, args, result;\n  var previous = 0;\n\n  var later = function() {\n    previous = Date.now();\n    timeout = null;\n    result = func.apply(context, args);\n    if (!timeout) context = args = null;\n  };\n\n  var throttled = function() {\n    var now = Date.now();\n    if (!previous) previous = now;\n    var remaining = wait - (now - previous);\n    context = this;\n    args = arguments;\n    if (remaining <= 0 || remaining > wait) {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = null;\n      }\n      previous = now;\n      result = func.apply(context, args);\n      if (!timeout) context = args = null;\n    } else if (!timeout) {\n      timeout = setTimeout(later, remaining);\n    }\n    return result;\n  };\n\n  throttled.cancel = function() {\n    clearTimeout(timeout);\n    previous = 0;\n    timeout = context = args = null;\n  };\n\n  return throttled;\n}\n\n// Fires once the DOM is ready\nexport function ready( fn ) {\n\n  if ( document.readyState != 'loading' ) {\n\n    fn();\n\n  } else {\n\n    document.addEventListener( 'DOMContentLoaded', fn );\n\n  }\n\n}\n","import * as utility from '../utils.js';\n\nexport default function( vidim ) {\n\n  /**\n   * Defaults specific to this provider\n   * @type {Object}\n   */\n  const defaults = {\n    preload: 'auto'\n  };\n\n  /**\n   * Provider definition object\n   * @type {Object}\n   */\n  const vidimHTML5Provider = {\n\n    /**\n     * Initial provider setup\n     */\n    _initializeProvider: function() {\n\n      utility.setDefaults( this._options, defaults );\n\n      this._constructPlayer();\n      this._dispatch();\n      this._listen();\n\n    },\n\n    /**\n     * Sets up the actual player\n     */\n    _constructPlayer: function() {\n\n      this.el = document.createElement( 'video' );\n\n      this.el.setAttribute( 'playsinline', '' );\n\n      if ( this._options.loop ) {\n\n        this.el.setAttribute( 'loop', '' );\n\n      }\n\n      if ( this._options.autoplay ) {\n\n        this.el.setAttribute( 'autoplay', '' );\n\n      }\n\n      if ( this._options.preload ) {\n\n        this.el.setAttribute( 'preload', this._options.preload );\n\n      }\n\n      if ( this._options.muted ) {\n\n        this.el.muted = true;\n\n      }\n\n      this.el.style.position = 'absolute';\n      this.el.style.left = '50%';\n      this.el.style.top = '50%';\n      this.el.style.transform = 'translate(-50%, -50%)';\n      this.el.style.webkitTransform = 'translate(-50%, -50%)';\n      this.el.style.msTransform = 'translate(-50%, -50%)';\n      this.el.style.oTransform = 'translate(-50%, -50%)';\n      this.el.style.mozTransform = 'translate(-50%, -50%)';\n      this.el.style.minWidth = 'calc( 100% + 2px )';\n      this.el.style.minHeight = 'calc( 100% + 2px )';\n      this.el.style.opacity = '0';\n\n      const src = this._options.src;\n\n      if ( src.length && 'string' !== typeof src ) {\n\n        for ( let i = 0; i < src.length; i++ ) {\n\n          let source = document.createElement( 'source' );\n\n          source.setAttribute( 'type', src[ i ].type );\n          source.setAttribute( 'src', src[ i ].src );\n\n          this.el.appendChild( source );\n\n        }\n\n      }\n\n      this.wrapper.appendChild( this.el );\n\n      if ( this._options.startAt ) {\n\n        this.el.currentTime = this._options.startAt;\n\n      }\n\n      if ( 'function' === typeof this._options.onReady ) {\n\n        this._options.onReady( this );\n\n      }\n\n      this.emit( 'ready' );\n\n      this._constructOverlay();\n\n      this.resize();\n\n    },\n\n    /**\n     * Dispatches normalized events\n     */\n    _dispatch: function() {\n\n      this.el.addEventListener( 'play', () => {\n\n        this.emit( 'play', this );\n\n      }, false );\n\n      this.el.addEventListener( 'pause', () => {\n\n        this.emit( 'pause', this );\n\n      }, false );\n\n      this.el.addEventListener( 'ended', () => {\n\n        this.emit( 'end', this );\n\n      }, false );\n\n      this.el.addEventListener( 'canplay', () => {\n\n        this.emit( 'canplay', this );\n\n      }, false );\n\n      this.el.addEventListener( 'canplaythrough', () => {\n\n        this.emit( 'canplaythrough', this );\n\n      }, false );\n\n    },\n\n    /**\n     * Any event listeners that are important to this provider\n     */\n    _listen: function() {\n\n      // Make sure we show the player once playback starts\n      this.on( 'play', () => {\n\n        this.el.style.opacity = '1';\n\n      });\n\n      // If the poster is hidden initially, set it once the play event happens\n      if ( ! this._options.showPosterBeforePlay ) {\n\n        this.once( 'play', () => {\n\n          this.wrapper.style.backgroundImage = `url('${this._options.poster}')`;\n\n        });\n\n      }\n\n      // Show poster on playback end\n      if ( this._options.showPosterOnEnd ) {\n\n        this.on( 'end', () => {\n\n          this.el.style.opacity = '0';\n\n        });\n\n      }\n\n      // Show poster on playback pause\n      if ( this._options.showPosterOnPause ) {\n\n        this.on( 'pause', () => {\n\n          this.el.style.opacity = '0';\n\n        });\n\n      }\n\n    },\n\n    /**\n     * Starts the video playback\n     */\n    play: function() {\n\n      this.el.play();\n\n      return this;\n\n    },\n\n    /**\n     * Pauses the video playback\n     */\n    pause: function() {\n\n      this.el.pause();\n\n      return this;\n\n    },\n\n    /**\n     * Sets the player volume\n     * @param {Number} [volume=100] Min = 0, Max = 100\n     */\n    setVolume: function( volume = 100 ) {\n\n      this.el.volume = parseFloat( volume / 100 );\n\n      return this;\n\n    },\n\n    /**\n     * Gets the player volume\n     * @returns {Number} Current player volume\n     */\n    getVolume: function() {\n\n      return this.el.volume * 100;\n\n    },\n\n    /**\n     * Mutes the player\n     */\n    mute: function() {\n\n      this.el.muted = true;\n\n      return this;\n\n    },\n\n    /**\n     * Unmutes the server\n     */\n    unMute: function() {\n\n      this.el.muted = false;\n\n      return this;\n\n    },\n\n    /**\n     * Sets the time player should seek to\n     * @param {Number} [time=0] Amount of seconds in the video to seek to\n     */\n    setTime: function( time = 0 ) {\n\n      this.el.currentTime = time;\n\n      return this;\n\n    },\n\n    /**\n     * Gets the time video playback is currently at\n     * @returns {Number} Number of seconds from start to the current position\n     */\n    getTime: function() {\n\n      return this.el.currentTime;\n\n    },\n\n    /**\n     * Gets video duration in seconds\n     * @returns {Number} Length of the video in seconds\n     */\n    getDuration: function() {\n\n      return this.el.duration;\n\n    },\n\n    /**\n     * Hides the media and shows the poster behind it\n     */\n    showPoster: function() {\n\n      this.pause().el.style.opacity = '0';\n\n    },\n\n    /**\n     * Changes the source of the current video\n     * @param {Object} src Hash of video types and sources\n     */\n    changeSource: function( src, newPoster = false ) {\n\n      this.el.innerHTML = '';\n\n      if ( src.length && 'string' !== typeof src ) {\n\n        for ( let i = 0; i < src.length; i++ ) {\n\n          let source = document.createElement( 'source' );\n\n          source.setAttribute( 'type', src[ i ].type );\n          source.setAttribute( 'src', src[ i ].src );\n\n          this.el.appendChild( source );\n\n        }\n\n      }\n\n      this.el.load && this.el.load();\n\n      if ( this._options.startAt ) {\n\n        this.el.currentTime = this._options.startAt;\n\n      }\n\n      if ( newPoster ) {\n\n        var oldPoster = this._options.poster;\n\n        if ( -1 !== this.wrapper.style.backgroundImage.indexOf( oldPoster ) ) {\n\n          this.wrapper.style.backgroundImage = `url('${newPoster}')`;\n\n        }\n\n        this._options.poster = newPoster;\n\n      }\n\n    },\n\n    /**\n     * Destroys and unloads the player\n     */\n    destroy: function() {\n\n      this.emit( 'destroy' );\n\n      this.el.pause && this.el.pause();\n      this.el.src = '';\n      this.el.load && this.el.load();\n\n      // We wrap this next part in try...catch in case the element is already\n      // gone for some reason\n      try {\n        this.wrapper.parentNode.removeChild( this.wrapper );\n      } catch ( e ) {\n\n        // do nothing here\n\n      }\n\n      vidim.deleteInstance( this.vidimID );\n\n      delete this.container.vidimID;\n\n      this.off();\n\n    },\n\n    /**\n     * Resizes the player to provide the best viewing experience\n     */\n    resize: function() {\n\n      if ( ! this.el ) {\n\n        return;\n\n      }\n\n      let containerHeight = this.container.offsetHeight,\n        containerWidth = this.container.offsetWidth;\n\n      if ( 'BODY' === this.container.nodeName ) {\n\n        containerWidth = window.innerWidth;\n        containerHeight = window.innerHeight;\n\n      }\n\n      if (\n        (\n             1 < this._options.ratio\n          && ( containerWidth / containerHeight ) < this._options.ratio\n        )\n        ||\n        (\n             1 > this._options.ratio\n          && ( containerHeight / containerWidth ) < this._options.ratio\n        )\n      ) {\n\n        this.el.style.maxHeight = 'calc( 100% + 2px )';\n        this.el.style.maxWidth = '';\n\n      } else {\n\n        this.el.style.maxHeight = '';\n        this.el.style.maxWidth = 'calc( 100% + 2px )';\n\n      }\n\n      this.emit( 'resize' );\n\n    }\n  };\n\n  vidim.registerProvider( 'HTML5', vidimHTML5Provider );\n\n}\n","/* global YT:false */\n\nimport * as utility from '../utils.js';\n\n/**\n * Will be set to true once YouTube API is ready\n * @type {Boolean}\n */\n\n// Theme will always make sure api is ready before calling\nlet isAPIReady = true;\n\nexport default function( vidim ) {\n\n  /**\n   * Defaults specific to this provider\n   * @type {Object}\n   */\n  const defaults = {\n    quality: 'hd1080'\n  };\n\n  /**\n   * Provider definition object\n   * @type {Object}\n   */\n  const vidimYouTubeProvider = {\n\n    /**\n     * Initial provider setup\n     */\n    _initializeProvider: function() {\n\n      if ( isAPIReady ) {\n\n        utility.setDefaults( this._options, defaults );\n\n        this._constructPlayer();\n        this._listen();\n\n      } else {\n        console.log('pre listener')\n        window.addEventListener( 'vidimYouTubeAPIReady', () => {\n\n          console.log('vidimYouTubeAPIReady');\n\n          isAPIReady = true;\n\n          utility.setDefaults( this._options, defaults );\n\n          this._constructPlayer();\n          this._listen();\n\n        }, false );\n\n      }\n\n    },\n\n    /**\n     * Sets up the actual player\n     */\n    _constructPlayer: function() {\n\n      // Check if YouTube ID was given, and if not, try to extract it from url\n      if ( 11 === this._options.src.length ) {\n\n        this.videoID = this._options.src;\n\n      } else {\n\n        let regex =\n          /^.*(youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|\\&v=|\\?v=)([^#\\&\\?]*).*/;\n\n        let videoMatch = this._options.src.match( regex );\n\n        if ( ! videoMatch || 11 !== videoMatch[2].length ) {\n\n          return new Error( 'Provided source is not a valid YouTube url' );\n\n        }\n\n        this.videoID = videoMatch[2];\n\n      }\n\n      // Create a temporary dom element that will be replaced by the\n      // YouTube iframe\n      let toBeReplaced = document.createElement( 'div' );\n\n      this.wrapper.appendChild( toBeReplaced );\n\n      const playerParams = {\n        videoId: this.videoID,\n        playerVars: {\n          allowfullscreen: false,\n          controls: 0,\n          enablejsapi: 1,\n          disablekb: 1,\n          fs: 0,\n          iv_load_policy: 3,\n          modestbranding: 1,\n          origin: typeof window.location.origin !== 'undefined'\n            ? window.location.origin\n            : `${window.location.protocol}//${window.location.hostname}${(window.location.port ? ':' + window.location.port : '')}`,\n          playsinline: 1,\n          rel: 0,\n          showinfo: 0,\n          start: this._options.startAt,\n          autoplay: +this._options.autoplay\n        },\n        events: {\n          'onReady': () => {\n\n            if ( this._options.muted ) {\n\n              this.mute();\n\n            }\n\n            this.player.setPlaybackQuality( this._options.quality );\n\n            if ( 'function' === typeof this._options.onReady ) {\n\n              this._options.onReady( this );\n\n            }\n\n            this.emit( 'ready' );\n\n            if ( this._options.loop ) {\n\n              let loopInterval;\n\n              this.on( 'play', () => {\n\n                loopInterval = setInterval( () => {\n\n                  if (\n                    this.getTime() === 0 ||\n                    this.getTime() + 0.15 > this.getDuration()\n                  ) {\n\n                    this.setTime( 0 );\n                    this.play();\n\n                  }\n\n                }, 100 );\n\n              });\n\n              this.on( 'pause', () => {\n\n                clearInterval( loopInterval );\n\n              });\n\n              this.on( 'destroy', () => {\n\n                clearInterval( loopInterval );\n\n              });\n\n            }\n\n          },\n          'onStateChange': ( e ) => {\n\n            switch ( e.data ) {\n\n              case ( 0 ) :\n                this.emit( 'end', this );\n                break;\n\n              case ( 1 ) :\n                this.emit( 'play', this );\n                break;\n\n              case ( 2 ) :\n                this.emit( 'pause', this );\n                break;\n\n              case ( 3 ) :\n                this.emit( 'buffering', this );\n                break;\n\n            }\n\n          }\n        }\n      };\n\n      if ( this._options.loop ) {\n\n        playerParams.playerVars.playlist = this.videoID;\n        playerParams.playerVars.loop = 1;\n\n      }\n\n      this.player = new YT.Player( toBeReplaced, playerParams );\n\n      this.el = this.player.getIframe();\n\n      this.el.style.position = 'absolute';\n      this.el.style.left = '50%';\n      this.el.style.top = '50%';\n      this.el.style.transform = 'translate(-50%, -50%)';\n      this.el.style.webkitTransform = 'translate(-50%, -50%)';\n      this.el.style.msTransform = 'translate(-50%, -50%)';\n      this.el.style.oTransform = 'translate(-50%, -50%)';\n      this.el.style.mozTransform = 'translate(-50%, -50%)';\n      this.el.style.minWidth = 'calc( 100% + 2px )';\n      this.el.style.minHeight = 'calc( 100% + 2px )';\n      this.el.style.opacity = '0';\n\n      this._constructOverlay();\n\n      this.resize();\n\n    },\n\n    /**\n     * Any event listeners that are important to this provider\n     */\n    _listen: function() {\n\n      // Make sure we show the player once playback starts\n      this.on( 'play', () => {\n\n        this.el.style.opacity = '1';\n\n      });\n\n      // If the poster is hidden initially, set it once the play event happens\n      if ( ! this._options.showPosterBeforePlay ) {\n\n        this.once( 'play', () => {\n\n          this.wrapper.style.backgroundImage = `url('${this._options.poster}')`;\n\n        });\n\n      }\n\n      // Show poster on playback end\n      if ( this._options.showPosterOnEnd ) {\n\n        this.on( 'end', () => {\n\n          this.el.style.opacity = '0';\n\n        });\n\n      } else {\n\n        // We don't want to display YouTube play button over our video,\n        // this is a hacky way to stop that from happening\n        this.on( 'end', () => {\n\n          this.player.seekTo( this.player.getDuration() );\n          this.player.playVideo();\n          this.player.pauseVideo();\n\n        });\n\n      }\n\n      // Show poster on playback pause\n      if ( this._options.showPosterOnPause ) {\n\n        this.on( 'pause', () => {\n\n          this.el.style.opacity = '0';\n\n        });\n\n      }\n\n    },\n\n    /**\n     * Starts the video playback\n     */\n    play: function() {\n\n      this.player.playVideo();\n\n      return this;\n\n    },\n\n    /**\n     * Pauses the video playback\n     */\n    pause: function() {\n\n      this.player.pauseVideo();\n\n      return this;\n\n    },\n\n    /**\n     * Sets the player volume\n     * @param {Number} [volume=100] Min = 0, Max = 100\n     */\n    setVolume: function( volume = 100 ) {\n\n      this.player.setVolume( volume );\n\n      return this;\n\n    },\n\n    /**\n     * Gets the player volume\n     * @returns {Number} Current player volume\n     */\n    getVolume: function() {\n\n      return this.getVolume();\n\n    },\n\n    /**\n     * Mutes the player\n     */\n    mute: function() {\n\n      this.player.mute();\n\n      return this;\n\n    },\n\n    /**\n     * Unmutes the server\n     */\n    unMute: function() {\n\n      this.player.unMute();\n\n      return this;\n\n    },\n\n    /**\n     * Sets the time player should seek to\n     * @param {Number} [time=0] Amount of seconds in the video to seek to\n     */\n    setTime: function( time = 0 ) {\n\n      this.player.seekTo( time, true );\n\n      return this;\n\n    },\n\n    /**\n     * Gets the time video playback is currently at\n     * @returns {Number} Number of seconds from start to the current position\n     */\n    getTime: function() {\n\n      return this.player.getCurrentTime();\n\n    },\n\n    /**\n     * Gets video duration in seconds\n     * @returns {Number} Length of the video in seconds\n     */\n    getDuration: function() {\n\n      return this.player.getDuration();\n\n    },\n\n    /**\n     * Hides the media and shows the poster behind it\n     */\n    showPoster: function() {\n\n      this.pause().el.style.opacity = '0';\n\n    },\n\n    /**\n     * Changes the source of the current video\n     * @param {Object} src Hash of video types and sources\n     */\n    changeSource: function( src, newPoster = false ) {\n\n      if ( 11 === src.length ) {\n\n        this.videoID = src;\n\n      } else {\n\n        let regex =\n          /^.*(youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|\\&v=|\\?v=)([^#\\&\\?]*).*/;\n\n        let videoMatch = src.match( regex );\n\n        if ( ! videoMatch || 11 !== videoMatch[2].length ) {\n\n          return new Error( 'Provided source is not a valid YouTube url' );\n\n        }\n\n        this.videoID = videoMatch[2];\n\n      }\n\n      this.player.loadPlaylist(\n        this.videoID,\n        0,\n        this._options.startAt,\n        this._options.quality\n      );\n\n      this.player.setLoop( this._options.loop );\n\n      if ( newPoster ) {\n\n        var oldPoster = this._options.poster;\n\n        if ( -1 !== this.wrapper.style.backgroundImage.indexOf( oldPoster ) ) {\n\n          this.wrapper.style.backgroundImage = `url('${newPoster}')`;\n\n        }\n\n        this._options.poster = newPoster;\n\n      }\n\n    },\n\n    /**\n     * Destroys and unloads the player\n     */\n    destroy: function() {\n\n      this.emit( 'destroy' );\n\n      this.player.destroy();\n\n      // We wrap this next part in try...catch in case the element is already\n      // gone for some reason\n      try {\n        this.wrapper.parentNode.removeChild( this.wrapper );\n      } catch ( e ) {\n\n        // do nothing here\n\n      }\n\n      vidim.deleteInstance( this.vidimID );\n\n      delete this.container.vidimID;\n\n      this.off();\n\n    },\n\n    /**\n     * Resizes the player to provide the best viewing experience\n     */\n    resize: function() {\n\n      if ( ! this.el ) {\n\n        return;\n\n      }\n\n      let containerHeight = this.container.offsetHeight,\n        containerWidth = this.container.offsetWidth;\n\n      if ( 'BODY' === this.container.nodeName ) {\n\n        containerWidth = window.innerWidth;\n        containerHeight = window.innerHeight;\n\n      }\n\n      if (\n        (\n             1 < this._options.ratio\n          && ( containerWidth / containerHeight ) < this._options.ratio\n        )\n        ||\n        (\n             1 > this._options.ratio\n          && ( containerHeight / containerWidth ) < this._options.ratio\n        )\n      ) {\n\n        this.el.style.maxHeight = 'calc( 100% + 2px )';\n        this.el.style.maxWidth = '';\n\n        this.el.style.height = '';\n        this.el.style.width =\n          ( this.el.offsetHeight * this._options.ratio ) + 200 + 'px';\n\n      } else {\n\n        this.el.style.maxHeight = '';\n        this.el.style.maxWidth = 'calc( 100% + 2px )';\n\n        this.el.style.height = this.el.offsetWidth / this._options.ratio + 'px';\n        this.el.style.width = '';\n\n        if ( this.el.offsetHeight < this.wrapper.offsetHeight + 140 ) {\n\n          this.el.style.height =\n            ( this.el.offsetWidth / this._options.ratio ) + 140 + 'px';\n\n        }\n\n      }\n\n      this.emit( 'resize' );\n\n    }\n  };\n\n  vidim.registerProvider( 'YouTube', vidimYouTubeProvider );\n\n}","import Emitter from 'component-emitter';\nimport * as utility from './utils.js';\nimport html5Provider from './providers/html5';\nimport YouTubeProvider from './providers/youtube';\n\n\n\nexport default ( function factory( global ) {\n\n  if ( 'undefined' === typeof global.document ) {\n\n    return;\n\n  }\n\n  /**\n   * Instance ID counter\n   * @type {Number}\n   */\n  let ID = 0;\n\n  /**\n   * Hashmap of instances\n   * @type {Object}\n   */\n  let instances = {};\n\n  /**\n   * Default options\n   * @type {Object}\n   */\n  const defaults = {\n    wrapperClass: '',\n    overlayClass: '',\n    src: false,\n    type: 'HTML5',\n    ratio: 1.7778,\n    autoplay: true,\n    loop: true,\n    poster: '',\n    showPosterBeforePlay: true,\n    showPosterOnEnd: false,\n    showPosterOnPause: false,\n    zIndex: 0,\n    autoResize: true,\n    muted: true,\n    startAt: 0,\n    onReady: false\n  };\n\n  /**\n   * Stores a list of option keys that the user provided, used for setting more\n   * sensible defaults\n   * @type {Array}\n   */\n  const optionsProvided = [];\n\n  /**\n   * Hashmap of providers\n   * @type {Object}\n   */\n  const providers = {};\n\n  /**\n   * Register a provider for handling media embeds\n   * @param  {String} type Short identifier for the media type handled\n   * @param  {Function|Object} Object or a function that returns object\n   */\n  function registerProvider( type, provider ) {\n\n    if ( 'function' === typeof provider ) {\n\n      providers[ type ] = provider.call( global, defaults );\n\n    } else {\n\n      providers[ type ] = provider;\n\n    }\n\n  }\n\n  /**\n   * Get instance by its ID\n   * @param  {integer} id Instance ID\n   * @returns {null|Object} null or instance if found\n   */\n  function getInstanceFromID( id ) {\n\n    if ( ! instances[ id ] ) {\n\n      return null;\n\n    }\n\n    return instances[ id ];\n\n  }\n\n  /**\n   * Get instance from the container element\n   * @param   {Object|string} element DOM element or a query string\n   * @returns {null|Object} null or instance if found\n   */\n  function getInstanceFromElement( element ) {\n\n    element = utility.getElement( element );\n\n    if (\n         'undefined' === typeof element.vidimID\n      || ! instances[ element.vidimID ]\n    ) {\n\n      return null;\n\n    }\n\n    return instances[ element.vidimID ];\n\n  }\n\n  /**\n   * Destroys all active instances\n   */\n  function destroyAllInstances() {\n\n    for ( let key in instances ) {\n\n      instances[ key ].hasOwnProperty( 'destroy' )\n      && instances[ key ].destroy();\n\n    }\n\n    instances = {};\n\n  }\n\n  /**\n   * Delete instance from the instances hash\n   * NOTE: this will not destroy the instance, only remove it from the\n   * instances hash. Call the destroy() method on the instance itself if you\n   * want to destroy it\n   * @param {string} id Instance ID\n   */\n  function deleteInstance( id ) {\n\n    delete instances[ id ];\n\n  }\n\n  // API method for scanning the DOM and initializing vide instances from\n  // data-vide attribute\n\n  /**\n   * Scan the DOM for elements that have data-vidim attribute and initialize\n   * new vidim instance based on that attribute\n   */\n  function scanDOM() {\n\n    const vidimElements = document.querySelectorAll( '[data-vidim]' );\n\n    if ( ! vidimElements.length ) {\n\n      return;\n\n    }\n\n    for ( let i = 0; i < vidimElements.length; i++ ) {\n\n      let element = vidimElements[ i ];\n      let options = element.getAttribute( 'data-vidim' );\n\n      if ( 'undefined' !== typeof element.vidimID ) {\n\n        // this element already has an instance of vidim\n        continue;\n\n      }\n\n      try {\n\n        // The things we do to avoid eval...\n        const regex =\n          /({|,)(?:\\s*)(?:')?([A-Za-z_$\\.][A-Za-z0-9_ \\-\\.$]*)(?:')?(?:\\s*):/g;\n\n        let fixedOptions = options\n          .replace( regex, '$1\"$2\":' )\n          .replace( /:\\s?'/g, ':\"' )\n          .replace( /'\\s?}/g, '\"}' )\n          .replace( /',\"/g, '\",\"' );\n\n        let parsedOptions = JSON.parse( fixedOptions );\n\n        new vidim( element, parsedOptions );\n\n      } catch ( e ) {\n\n        // do nothing\n\n      }\n\n    }\n\n  }\n\n  /**\n   * Used for instantiating new instances\n   * @param {Object|string} element DOM element or a query string\n   * @param {Object} [options={}] Options hash\n   */\n  function vidim( element, options = {} ) {\n\n    Object.keys( options ).forEach( ( key ) => {\n\n      optionsProvided.push( key );\n\n    });\n\n    // Set defaults\n    utility.setDefaults( options, defaults );\n\n    if ( options.src && ! providers[ options.type ] ) {\n\n      return new Error( `No provider can handle type: '${options.type}'` );\n\n    }\n\n    if ( 'string' === typeof options.ratio ) {\n\n      if ( '4/3' === options.ratio ) {\n\n        options.ratio = 4/3;\n\n      } else {\n\n        options.ratio = 16/9;\n\n      }\n\n    }\n\n    this._options = options;\n    this.container = utility.getElement( element );\n\n    if ( ! this.container ) {\n\n      return new Error( `Could not find the container: ${element}` );\n\n    }\n\n    // Set more sensitive defaults\n    if (\n         -1 === optionsProvided.indexOf( 'zIndex' )\n      && 'BODY' === this.container.nodeName\n    ) {\n\n      this._options.zIndex = -1;\n\n    }\n\n    this._initialize();\n\n  }\n\n  const prototype = vidim.prototype;\n\n\n  /**\n   * Initializes the instance and does the work common to all providers\n   */\n  prototype._initialize = function() {\n\n    // Assign a unique ID to this instance, and make sure we store it on the\n    // container for convenience\n    this.vidimID = ID++;\n    this.container.vidimID = this.vidimID;\n\n    instances[ this.vidimID ] = this;\n\n    // Add emitter interface to our instance\n    Emitter( this );\n\n    // Check if poster was provided but the source was not,\n    // in that case we fake a simple provider interface that only displays a\n    // poster\n    if ( ! this._options.src && this._options.poster ) {\n\n      this._constructWrapper();\n\n      this.destroy = function() {\n\n        this.emit( 'destroy' );\n\n        // We wrap this next part in try...catch in case the element is already\n        // gone for some reason\n        try {\n          this.wrapper.parentNode.removeChild( this.wrapper );\n        } catch ( e ) {\n\n          // do nothing here\n\n        }\n\n        vidim.deleteInstance( this.vidimID );\n\n        delete this.container.vidimID;\n\n        this.off();\n\n      };\n\n      return;\n\n    }\n\n    const provider = providers[ this._options.type ];\n\n    for ( let key in provider ) {\n\n      this[ key ] = provider[ key ];\n\n    }\n\n    if ( 'function' !== typeof this._initializeProvider ) {\n\n      return new Error( 'Provider is missing method: _initializeProvider' );\n\n    }\n\n    this._constructWrapper();\n    this._initializeProvider();\n\n    if ( this._options.autoResize ) {\n\n      window.addEventListener(\n        'resize',\n        utility.throttle( this.resize, 200 ).bind( this ),\n        false\n      );\n\n    }\n\n    this.resize();\n\n  };\n\n  /**\n   * Generates a wrapper that is used for holding the media\n   */\n  prototype._constructWrapper = function() {\n\n    const containerStyle = getComputedStyle( this.container, null );\n\n    if ( 'static' === containerStyle.getPropertyValue( 'position' ) ) {\n\n      this.container.style.position = 'relative';\n\n    }\n\n    this.wrapper = document.createElement( 'div' );\n\n    if ( 'BODY' === this.container.nodeName ) {\n\n      this.wrapper.style.position = 'fixed';\n\n    } else {\n\n      this.wrapper.style.position = 'absolute';\n\n    }\n\n    if ( this._options.wrapperClass ) {\n\n      if ( 'function' === typeof this._options.wrapperClass ) {\n\n        this.wrapper.classList.add( this._options.wrapperClass.call( this ) );\n\n      } else {\n\n        this.wrapper.classList.add( this._options.wrapperClass );\n\n      }\n\n    }\n\n    this.wrapper.style.left = 0;\n    this.wrapper.style.top = 0;\n    this.wrapper.style.height = '100%';\n    this.wrapper.style.width = '100%';\n    this.wrapper.style.overflow = 'hidden';\n    this.wrapper.style.zIndex = parseInt( this._options.zIndex, 10 );\n\n    if ( this._options.poster ) {\n\n      this.wrapper.style.backgroundSize = 'cover';\n      this.wrapper.style.backgroundPosition = 'center center';\n      this.wrapper.style.backgroundRepear = 'no-repeat';\n\n      if ( this._options.showPosterBeforePlay ) {\n\n        this.wrapper.style.backgroundImage = `url('${this._options.poster}')`;\n\n      }\n\n    }\n\n    this.container.insertBefore( this.wrapper, this.container.firstChild );\n\n  };\n\n  /**\n   * Generates an overlay that is placed above the media to prevent interaction\n   */\n  prototype._constructOverlay = function() {\n\n    this.overlay = document.createElement( 'div' );\n\n    this.overlay.style.position = 'absolute';\n\n    if ( this._options.overlayClass ) {\n\n      if ( 'function' === typeof this._options.overlayClass ) {\n\n        this.overlay.classList.add( this._options.overlayClass.call( this ) );\n\n      } else {\n\n        this.overlay.classList.add( this._options.overlayClass );\n\n      }\n\n    }\n\n    this.overlay.style.left = 0;\n    this.overlay.style.top = 0;\n    this.overlay.style.height = '100%';\n    this.overlay.style.width = '100%';\n\n    this.wrapper.appendChild( this.overlay );\n\n  };\n\n  // Provide method for retrieving vidim instance by its id\n  vidim.getInstanceFromID = getInstanceFromID;\n\n  // Provide method for retrieving vidim instance from the container element\n  vidim.getInstanceFromElement = getInstanceFromElement;\n\n  // Provide method for registering new providers\n  vidim.registerProvider = registerProvider;\n\n  // Provide method for destroying all instances\n  vidim.destroyAllInstances = destroyAllInstances;\n\n  // Provide method for deleting the instance from instances hash\n  vidim.deleteInstance = deleteInstance;\n\n  // Export our utils functions as well so providers can make use of them\n  vidim.utility = utility;\n\n  // Provide method for scanning the DOM and initializing vidim from attribute\n  vidim.scanDOM = scanDOM;\n\n  // Initialize providers\n  html5Provider( vidim );\n  YouTubeProvider( vidim );\n\n  // Parse the DOM an auto initialize based on the [data-vidim] attribute\n  utility.ready( scanDOM );\n\n  return vidim;\n\n})( 'undefined' !== typeof window ? window : undefined );\n"],"names":["setDefaults","object","defaults","defaultsKeys","Object","keys","forEach","key","hasOwnProperty","getElement","query","parent","document","querySelector","throttle","func","wait","timeout","context","args","result","previous","later","Date","now","apply","throttled","remaining","arguments","setTimeout","cancel","ready","fn","readyState","addEventListener","vidim","vidimHTML5Provider","_options","_constructPlayer","_dispatch","_listen","el","createElement","setAttribute","loop","autoplay","preload","muted","style","position","left","top","transform","webkitTransform","msTransform","oTransform","mozTransform","minWidth","minHeight","opacity","src","length","i","source","type","appendChild","wrapper","startAt","currentTime","onReady","emit","_constructOverlay","resize","on","showPosterBeforePlay","once","backgroundImage","poster","showPosterOnEnd","showPosterOnPause","play","pause","volume","parseFloat","time","duration","newPoster","innerHTML","load","oldPoster","indexOf","parentNode","removeChild","e","deleteInstance","vidimID","container","off","containerHeight","offsetHeight","containerWidth","offsetWidth","nodeName","window","innerWidth","innerHeight","ratio","maxHeight","maxWidth","registerProvider","isAPIReady","vidimYouTubeProvider","log","videoID","regex","videoMatch","match","Error","toBeReplaced","playerParams","location","origin","protocol","hostname","port","mute","player","setPlaybackQuality","quality","loopInterval","setInterval","getTime","getDuration","setTime","data","playerVars","playlist","YT","Player","getIframe","seekTo","playVideo","pauseVideo","setVolume","getVolume","unMute","getCurrentTime","loadPlaylist","setLoop","destroy","height","width","factory","global","ID","instances","optionsProvided","providers","provider","call","getInstanceFromID","id","getInstanceFromElement","element","utility","destroyAllInstances","scanDOM","vidimElements","querySelectorAll","options","getAttribute","fixedOptions","replace","parsedOptions","JSON","parse","push","zIndex","_initialize","prototype","_constructWrapper","_initializeProvider","autoResize","bind","containerStyle","getComputedStyle","getPropertyValue","wrapperClass","classList","add","overflow","parseInt","backgroundSize","backgroundPosition","backgroundRepear","insertBefore","firstChild","overlay","overlayClass","undefined"],"mappings":"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"}